ap_space_engineers = {
	possible = {
		custom_tooltip = { fail_text = "ap_space_engineers_req_1" has_technology = tech_starbase_5 }
		custom_tooltip = { fail_text = "ap_space_engineers_req_2" has_technology = tech_engineering_3 }
		custom_tooltip = { fail_text = "ap_space_engineers_req_3" has_ascension_perk = ap_eternal_vigilance }
		# custom_tooltip = { fail_text = "ap_space_engineers_req_4" has_ascension_perk = ap_grasp_the_void }
	}
	# v3.3 reduced
	modifier = {
		# country_starbase_capacity_mult = 0.1	removed in v3.7	# 1.0
		starbases_upkeep_mult = -0.25		# -0.50
		# starbase_upgrade_cost_mult = -0.1 # -0.25 removed in v3.4
		starbase_upgrade_speed_mult = 2		# 4.00
		# starbase_modules_cost_mult = -0.15
		starbase_module_build_speed_mult = 2		# 4.00
		# starbase_modules_upkeep_mult = -0.25
		# starbase_buildings_cost_mult = -0.15
		starbase_building_build_speed_mult = 2		# 4.00
		# starbase_buildings_upkeep_mult = -0.25
	}
	on_enabled = {
		custom_tooltip = "ap_space_engineers_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.1 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_space_engineers }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_space_engineers value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = {
		factor = event_target:global_event_country.ap_space_engineers
		modifier = { factor = 2 has_ethic = ethic_militarist }
		modifier = { factor = 5 has_ethic = ethic_fanatic_militarist }
	}
}

ap_stellar_manipulation = {
	possible = {
		custom_tooltip = { fail_text = "ap_stellar_manipulation_req_1" has_technology = tech_volcano }
		custom_tooltip = { fail_text = "ap_stellar_manipulation_req_2" has_technology = tech_mountain_range }
		custom_tooltip = { fail_text = "ap_stellar_manipulation_req_3" has_technology = tech_dangerous_wildlife }
		custom_tooltip = { fail_text = "ap_stellar_manipulation_req_4" has_technology = tech_dense_jungle }
		custom_tooltip = { fail_text = "ap_stellar_manipulation_req_5" has_technology = tech_quicksand_basin }
		custom_tooltip = { fail_text = "ap_stellar_manipulation_req_6" has_technology = tech_noxious_swamp }
		custom_tooltip = { fail_text = "ap_stellar_manipulation_req_7" has_technology = tech_massive_glacier }
		custom_tooltip = { fail_text = "ap_stellar_manipulation_req_8" has_technology = tech_toxic_kelp }
		custom_tooltip = { fail_text = "ap_stellar_manipulation_req_9" has_technology = tech_deep_sinkhole }
	}
	on_enabled = {
		custom_tooltip = "ap_stellar_manipulation_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.10 }
		}
	}
	potential = {
		NOR = {
			is_ai = yes
			has_ascension_perk = ap_stellar_manipulation
			has_global_flag = ap_stellar_manipulation
		}
	}
	ai_weight = { factor = 0 }	# event_target:global_event_country.ap_stellar_manipulation
}

ap_lost_heritage = {
	possible = {
		custom_tooltip = { fail_text = "ap_lost_heritage_req_1" has_technology = tech_hyper_drive_3 }
		custom_tooltip = { fail_text = "ap_lost_heritage_req_2" has_technology = tech_wormhole_stabilization }
		custom_tooltip = { fail_text = "ap_lost_heritage_req_3" has_technology = tech_experimental_subspace_navigation }
		custom_tooltip = { fail_text = "ap_lost_heritage_req_4" has_technology = tech_mine_dark_matter }
		custom_tooltip = { fail_text = "ap_lost_heritage_req_5" controlled_systems > 4 }
	}
	on_enabled = {
		custom_tooltip = "ap_lost_heritage_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.20 }
		}
	}
	potential = {
		NOR = {
			is_ai = yes
			has_ascension_perk = ap_lost_heritage
			has_global_flag = ap_lost_heritage
		}
	}
	ai_weight = {
		factor = 0
		# factor = event_target:global_event_country.ap_lost_heritage
		# modifier = { factor = 2 has_ethic = ethic_materialist }
		# modifier = { factor = 5 has_ethic = ethic_fanatic_materialist }
	}
}

ap_void_expedition = {
	possible = {
		custom_tooltip = { fail_text = "ap_void_expedition_req_1" has_ascension_perk = ap_lost_heritage }
		custom_tooltip = { fail_text = "ap_void_expedition_req_2" tradition_discovery_finish = yes }
		custom_tooltip = { fail_text = "ap_void_expedition_req_3" has_technology = tech_automated_exploration }
		custom_tooltip = { fail_text = "ap_void_expedition_req_4" has_technology = tech_cryostasis_2 }
		custom_tooltip = { fail_text = "ap_void_expedition_req_5" has_technology = tech_physics_3 }
		custom_tooltip = { fail_text = "ap_void_expedition_req_6" has_technology = tech_space_science_5 }
		has_distar = yes
	}
	modifier = { science_ship_survey_speed = 0.5 }
	on_enabled = {
		custom_tooltip = "ap_void_expedition_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.143 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_void_expedition }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_void_expedition value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_void_expedition }
}

# TODO
# ap_sector_z749 = {
# 	possible = {
# 		custom_tooltip = { fail_text = "ap_sector_z749_req_1" has_technology = tech_dangerous_systems }
# 		custom_tooltip = { fail_text = "ap_sector_z749_req_2" has_ascension_perk = ap_void_expedition }
# 	}
# 	on_enabled = {
# 		custom_tooltip = "ap_sector_z749_tooltip"
# 		hidden_effect = { country_event = { id = UniqueAscensionPerksEvents.270 } }
# 	}
# 	potential = { NOT = { has_ascension_perk = ap_sector_z749 } }
# 	ai_weight = { factor = 0 }
# }
ap_expandable_brain_1 = {
	possible = {
		custom_tooltip = {
			fail_text = "ap_expandable_brain_1_req_1"
			OR = {
				has_ascension_perk = ap_transcendent_learning
				has_ascension_perk = ap_esap_gov_2
				has_ascension_perk = ap_esap_gov_GC_2
			}
		}
		custom_tooltip = { fail_text = "ap_expandable_brain_1_req_2" has_modifier = expandable_brain_1 }
	}
	on_enabled = {
		custom_tooltip = "ALLOW_LEADER_MIN_LVL_3"
		custom_tooltip = "ALLOW_LEADER_MIN_TRAIT_2"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.33 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_expandable_brain_1 }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_expandable_brain_1 value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_expandable_brain_1 }
}

ap_expandable_brain_2 = {
	possible = {
		custom_tooltip = { fail_text = "ap_expandable_brain_2_req_1" has_ascension_perk = ap_expandable_brain_1 }
		custom_tooltip = { fail_text = "ap_expandable_brain_2_req_2" has_technology = tech_expandable_brain_1 }
		custom_tooltip = { fail_text = "ap_expandable_brain_2_req_3" has_modifier = expandable_brain_2 }
		custom_tooltip = { fail_text = "ap_expandable_brain_2_req_4" has_technology = tech_expandable_brain_2 }
	}
	modifier = { }
	on_enabled = {
		custom_tooltip = "ALLOW_LEADER_MIN_LVL_5"
		custom_tooltip = "ALLOW_LEADER_MIN_TRAIT_3"
		custom_tooltip = "ap_expandable_brain_2_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.37 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_expandable_brain_2 }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_expandable_brain_2 value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_expandable_brain_2 }
}

ap_ai_cortana = {
	possible = {
		custom_tooltip = { fail_text = "ap_ai_cortana_req_1" has_technology = tech_administrative_ai }
		custom_tooltip = {
			fail_text = "ap_ai_cortana_req_2"
			resource_stockpile_compare = { resource = energy value >= 40000 }
		}
	}
	modifier = {
		all_technology_research_speed = 0.05		# 0.10
		num_tech_alternatives_add = 1		# 2
	}
	on_enabled = {
		custom_tooltip = "ap_ai_cortana_tooltip"
		set_country_flag = cortana_ready
		hidden_effect = {
			country_event = { id = CortanaEvent.100 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_ai_cortana }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_ai_cortana value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_ai_cortana }
}

# Nano Drone Workers
ap_nano_drones = {
	possible = {
		# custom_tooltip = { fail_text = "ap_nano_drones_req_1" has_technology = tech_auto_drone }
	}
	modifier = { planet_max_buildings_add = 3 }
	on_enabled = {
		custom_tooltip = "ap_nano_drones_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.40 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_nano_drones }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_nano_drones value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_nano_drones }
}

# Nanite Composition
# v3.3 halved values
ap_nano_to_nanite = {
	possible = {
		custom_tooltip = { fail_text = "ap_nano_drones_req_1" has_technology = tech_auto_drone }
		custom_tooltip = { fail_text = "ap_nano_to_nanite_req_1" has_ascension_perk = ap_nano_drones }
		custom_tooltip = {
			fail_text = "ap_nano_to_nanite_req_2"
			resource_stockpile_compare = { resource = automatic_drone value > 37500 }
		}
		has_distar = yes
	}
	modifier = {
		ship_hull_regen_add_static = 2.5
		ship_armor_regen_add_static = 2
		ship_shield_regen_add_static = 1.5
		country_base_nanites_produces_add = 2
	}
	on_enabled = {
		custom_tooltip = "ap_nano_to_nanite_tooltip_1"
		custom_tooltip = "ap_nano_to_nanite_tooltip_2"
		custom_tooltip = "ap_nano_to_nanite_tooltip_3"
		custom_tooltip = "ap_nano_to_nanite_tooltip_4"
		add_resource = { automatic_drone = -37500 }
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.8001 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_nano_to_nanite }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_nano_to_nanite value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_nano_to_nanite }
}

# Genius Pregnancy
# v3.4 reduced growth_speed
ap_genius_cloning = {
	possible = {
		custom_tooltip = { fail_text = "ap_genius_cloning_req_1" has_technology = tech_cloning }
		custom_tooltip = { fail_text = "ap_genius_cloning_req_2" has_technology = tech_housing_2 }
		custom_tooltip = { fail_text = "ap_genius_cloning_req_3" tradition_expansion_finish = yes }
		custom_tooltip = { fail_text = "ap_requires_1_perk" num_ascension_perks > 0 }
	}
	modifier = { pop_growth_speed = 0.15 }	# 0.3 < v3.4
	on_enabled = {
		custom_tooltip = "ap_genius_cloning_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.41 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_genius_cloning }
		OR = {
			is_machine_empire = no
			has_civic = civic_machine_assimilator
			has_civic = civic_machine_servitor
		}
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_genius_cloning value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = {
		factor = event_target:global_event_country.ap_genius_cloning
		modifier = { factor = 5 is_hive_empire = yes }
	}
}

# TODO may split in 2 AP?
ap_adv_colonisation = {
	possible = {
		custom_tooltip = { fail_text = "ap_adv_colonisation_req_1" has_technology = tech_cryostasis_2 }
		custom_tooltip = {
			fail_text = "ap_adv_colonisation_req_2"
			OR = {
				is_machine_empire = yes
				has_technology = tech_colonization_5
			}
		}
		custom_tooltip = { fail_text = "ap_adv_colonisation_req_3" tradition_expansion_finish = yes }
	}
	modifier = {
		planet_colony_development_speed_mult = -0.75
		colony_start_num_pops_add = 8		# Reduced from 29 with 3.3 due imbalance
		ship_colonizer_cost_mult = 3
		shipsize_colonizer_build_speed_mult = -0.75
		shipsize_colonizer_hull_mult = 5
		shipclass_colonizer_evasion_add = 40
		shipclass_colonizer_disengage_mult = 2
		planet_housing_add = 10		# 35 removed with v3.3 due imbalance
		# planet_max_districts_add = 1 # v3.3
		# pop_environment_tolerance = 0.05
	}
	on_enabled = {
		custom_tooltip = "ap_adv_colonisation_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.43 }
			every_owned_fleet = {
				limit = { is_ship_class = shipclass_colonizer }
				destroy_fleet = this
			}
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_adv_colonisation }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_adv_colonisation value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = {
		factor = event_target:global_event_country.ap_adv_colonisation
		modifier = { factor = 5 is_gestalt = yes }
	}
}

# TODO may split in 2 AP?
# Something Like 'Ultimate Prefabrication'.
# That Instantly Colonizes A Planet As Soon As The Colony Ship Touches Down.
# v3.3: halved values
ap_expansion_infinity = {
	possible = {
		custom_tooltip = { fail_text = "ap_expansion_infinity_req_1" has_ascension_perk = ap_adv_colonisation }
		custom_tooltip = { fail_text = "ap_expansion_infinity_req_2" has_technology = tech_construction_templates }
		custom_tooltip = { fail_text = "ap_expansion_infinity_req_3" has_technology = tech_galactic_administration }
	}
	modifier = {
		planet_max_buildings_add = 10		# 30
		planet_max_districts_add = 3
		# planet_max_districts_mult = 0.5 # 1.00
		planet_building_build_speed_mult = 0.5		# 1.00
		planet_buildings_cost_mult = -0.15		# -0.25
		planet_decision_enact_speed_mult = 0.5		# 1.00
		planet_housing_mult = 0.05		# 0.20
		# planet_buildings_volatile_motes_upkeep_mult	= -0.25 # -0.50
		# planet_buildings_exotic_gases_upkeep_mult	= -0.25 # -0.50
		# planet_buildings_rare_crystals_upkeep_mult	= -0.25 # -0.50
		# planet_districts_volatile_motes_upkeep_mult	= -0.25 # -0.50
		# planet_districts_exotic_gases_upkeep_mult	= -0.25 # -0.50
		# planet_districts_rare_crystals_upkeep_mult	= -0.25 # -0.50
		planet_buildings_upkeep_mult = -0.2
		planet_districts_upkeep_mult = -0.2
		planet_colony_development_speed_mult = 1		# 2 v3.4.5
	}
	on_enabled = {
		custom_tooltip = "ap_expansion_infinity_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.45 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_expansion_infinity }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_expansion_infinity value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = {
		factor = event_target:global_event_country.ap_expansion_infinity
		modifier = { factor = 5 is_gestalt = yes }
	}
}

# Recycling Expeditions
ap_recycling_drones = {
	possible = {
		custom_tooltip = { fail_text = "ap_requires_2_perk" num_ascension_perks > 1 }
	}
	modifier = {
		# country_ship_upgrade_cost_mult = -0.25 # -0.66 removed in v3.4.5
		starbase_shipyard_build_speed_mult = 0.5		# 0.75
		shipclass_military_build_cost_mult = 0.1
		shroud_ship_upkeep = -0.2		# v.3.4.5
		ships_upkeep_mult = -0.1		# v.3.8.1
	}
	on_enabled = {
		custom_tooltip = "ap_recycling_drones_tooltip_1"
		custom_tooltip = "ap_recycling_drones_tooltip_2"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.47 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_recycling_drones }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_recycling_drones value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = {
		factor = event_target:global_event_country.ap_recycling_drones
		modifier = { factor = 2 has_ethic = ethic_militarist }
		modifier = { factor = 5 has_ethic = ethic_fanatic_militarist }
	}
}

# v3.3 reduced values
ap_emergency_calculation = {
	possible = {
		custom_tooltip = { fail_text = "ap_emergency_calculation_req_1" has_technology = tech_zero_point_power }
		custom_tooltip = { fail_text = "ap_emergency_calculation_req_2" has_technology = tech_hyper_drive_3 }
		custom_tooltip = { fail_text = "ap_emergency_calculation_req_3" has_technology = tech_thrusters_4 }
		custom_tooltip = {
			fail_text = "ap_emergency_calculation_req_4"
			OR = {
				has_technology = tech_combat_computers_3
				has_technology = tech_combat_computers_autonomous
				has_technology = tech_precognition_interface
			}
		}
	}
	modifier = {
		ship_disengage_chance_mult = 0.25			# 2.0
		ship_disengage_opportunities_add = 1
		ship_emergency_ftl_min_days_mult = -0.25	# -0.5
		ship_ftl_jumpdrive_range_mult = 0.15		# 0.25
		country_war_exhaustion_mult = -0.1			# -0.2
	}
	on_enabled = {
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.53 }
		}
		custom_tooltip = "ap_emergency_calculation_tooltip"
	}
	potential = {
		NOT = { has_ascension_perk = ap_emergency_calculation }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_emergency_calculation value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = {
		factor = event_target:global_event_country.ap_emergency_calculation
		modifier = { factor = 2 has_ethic = ethic_pacifist }
		modifier = { factor = 5 has_ethic = ethic_fanatic_pacifist }
	}
}

# TODO check compt.: trade_policy gets overwritten by some larger mods
ap_economic_prospertity = {
	possible = {
		custom_tooltip = { fail_text = "ap_economic_prospertity_req_1" tradition_prosperity_finish = yes }
		custom_tooltip = { fail_text = "ap_economic_prospertity_req_2" OR = { has_technology = tech_galactic_markets is_megacorp = yes } }
		custom_tooltip = { fail_text = "ap_economic_prospertity_req_3" NOT = { has_global_flag = emex_version_rejuvenation } } # 'Empires Expanded'
		custom_tooltip = { fail_text = "ap_economic_prospertity_req_4" NAND = { has_global_flag = bug_branch_active has_bug_branch = yes } } # Ethics and Civics - Bug Branch
	}
	modifier = {
		country_trade_fee = -0.1
		trade_value_mult = 0.15
		country_energy_produces_mult = 0.05
		country_resource_max_energy_add = 10000
		# branch_office_value_mult = 0.75
	}
	on_enabled = {
		custom_tooltip = "ap_economic_prospertity_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.54 }
		}
		add_resource = { energy = 10000 }
	}
	potential = {
		NOT = { has_ascension_perk = ap_economic_prospertity }
		is_gestalt = no
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_economic_prospertity value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = {
		factor = event_target:global_event_country.ap_economic_prospertity
		modifier = { factor = 5 is_megacorp = yes }
	}
}

ap_chosen_ruler = {
	possible = {
		custom_tooltip = { fail_text = "ap_chosen_ruler_req_1" tradition_domination_finish = yes }
		custom_tooltip = { fail_text = "ap_requires_1_perk" num_ascension_perks > 0 }
	}
	modifier = { ruler_skill_levels = 4 }
	on_enabled = {
		custom_tooltip = "ap_chosen_ruler_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.320 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_chosen_ruler }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_chosen_ruler value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = {
		factor = event_target:global_event_country.ap_chosen_ruler
		modifier = { factor = 2 has_ethic = ethic_authoritarian }
		modifier = { factor = 5 has_ethic = ethic_fanatic_authoritarian }
	}
}

# v3.3 reduced values
ap_advanced_security = {
	possible = { }
	modifier = {
		planet_crime_add = -15		# -40
		# planet_crime_no_happiness_add = -20
		planet_crime_mult = -0.20
		# planet_crime_no_happiness_mult = -0.25
		local_trade_protection_add = 25		# 50
	}
	on_enabled = {
		custom_tooltip = "ap_advanced_security_tooltip_1"
		custom_tooltip = "ap_advanced_security_tooltip_2"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.55 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_advanced_security }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_advanced_security value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = {
		factor = event_target:global_event_country.ap_advanced_security
		modifier = { factor = 2 has_ethic = ethic_authoritarian }
		modifier = { factor = 5 has_ethic = ethic_fanatic_authoritarian }
	}
}

ap_space_domestication = {
	possible = {
		custom_tooltip = { fail_text = "ap_space_domestication_req_1" tradition_domination_finish = yes }
		custom_tooltip = { fail_text = "ap_space_domestication_req_2" has_technology = tech_power_plant_3 }
		custom_tooltip = { fail_text = "ap_space_domestication_req_3" has_technology = tech_nano_vitality_crops }
		custom_tooltip = { fail_text = "ap_space_domestication_req_4" has_technology = tech_mining_3 }
		has_leviathans = yes
		custom_tooltip = { fail_text = "requires_independence" is_subject = no }
		custom_tooltip = { fail_text = "ap_requires_2_perk" num_ascension_perks > 1 }
	}
	modifier = {
		damage_vs_country_type_crystal_mult = 0.25
		damage_vs_country_type_amoeba_mult = 0.25
		damage_vs_country_type_cloud_mult = 0.25
		damage_vs_country_type_tiyanki_mult = 0.25
		damage_vs_country_type_drone_mult = 0.1
	}
	on_enabled = {
		custom_tooltip = "ap_space_domestication_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.1000 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_space_domestication }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_space_domestication value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_space_domestication }
}

ap_leviathan_master = {
	possible = {
		custom_tooltip = { fail_text = "ap_leviathan_master_req_1" has_ascension_perk = ap_space_domestication }
		custom_tooltip = { fail_text = "ap_leviathan_master_req_2" has_country_flag = space_domestication_project_completed }
		custom_tooltip = {
			fail_text = "ap_leviathan_master_req_3"
			OR = {
				has_technology = tech_nutrient_replication
				is_machine_empire = yes
			}
		}
		custom_tooltip = { fail_text = "ap_leviathan_master_req_4" has_country_flag = has_killed_leviathan }
		has_leviathans = yes
		custom_tooltip = { fail_text = "requires_independence" is_subject = no }
	}
	modifier = {
		damage_vs_country_type_guardian_elderly_tiyanki_mult = 0.25
		damage_vs_country_type_guardian_hatchling_mult = 0.25
		damage_vs_country_type_guardian_wraith_mult = 0.25
		damage_vs_country_type_guardian_stellarite_mult = 0.25
		damage_vs_country_type_guardian_dragon_mult = 0.2
		# damage_vs_country_type_guardian_horror_mult = 0.1
		# damage_vs_country_type_guardian_sphere_mult = 0.1
		# damage_vs_country_type_guardian_scavenger_bot_mult = 0.1
		damage_vs_country_type_ldragon_country_mult = 0.1
	}
	on_enabled = {
		custom_tooltip = "ap_leviathan_master_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.1051 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_leviathan_master }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_leviathan_master value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_leviathan_master }
}

ap_friendly_nature = {
	possible = {
		custom_tooltip = {
			fail_text = "ap_friendly_nature_req_1"
			OR = {
				is_machine_empire = yes
				has_technology = tech_colonization_5
			}
		}
		custom_tooltip = { fail_text = "ap_friendly_nature_req_2" has_technology = tech_society_3 }
		custom_tooltip = { fail_text = "ap_friendly_nature_req_3" has_technology = tech_ecological_adaptation }
	}
	modifier = { }
	on_enabled = {
		custom_tooltip = "ap_friendly_nature_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.59 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_friendly_nature }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_friendly_nature value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = {
		factor = event_target:global_event_country.ap_friendly_nature
		modifier = { factor = 2 has_ethic = ethic_pacifist }
		modifier = { factor = 5 has_ethic = ethic_fanatic_pacifist }
	}
}

# Robotic Assemblers
# v3.4 reduced growth_speed
ap_robot_command = {
	possible = {
		custom_tooltip = {
			fail_text = "ap_robot_command_req_1"
			OR = {
				is_machine_empire = yes
				has_technology = tech_robotic_workers
			}
		}
		custom_tooltip = {
			fail_text = "ap_robot_command_req_2"
			OR = {
				has_technology = tech_robomodding_m
				has_technology = tech_robomodding
			}
		}
		custom_tooltip = { fail_text = "ap_robot_command_req_3" has_technology = tech_assembly_pattern }
		custom_tooltip = {
			fail_text = "ap_robot_command_req_4"
			any_owned_pop = {
				OR = {
					pop_has_trait = trait_mechanical
					pop_has_trait = trait_machine_unit
				}
			}
		}
		custom_tooltip = { fail_text = "ap_requires_1_perk" num_ascension_perks > 0 }
	}
	modifier = { planet_pop_assembly_mult = 0.2 }	# 0.3 < v3.4
	on_enabled = {
		custom_tooltip = "ap_robot_command_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.61 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_robot_command }
		is_hive_empire = no
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_robot_command value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = {
		factor = event_target:global_event_country.ap_robot_command
		modifier = { factor = 2 has_ethic = ethic_materialist }
		modifier = { factor = 5 has_ethic = ethic_fanatic_materialist }
	}
}

ap_recomposer = {
	possible = {
		custom_tooltip = { fail_text = "ap_recomposer_req_1" has_technology = tech_synthetic_leaders }
		custom_tooltip = { fail_text = "ap_recomposer_req_2" has_technology = tech_sapient_ai }
		# custom_tooltip = { fail_text = "ap_recomposer_req_3" has_ascension_perk = ap_genius_cloning }
		# custom_tooltip = { fail_text = "ap_recomposer_req_4" has_ascension_perk = ap_robot_command }
		custom_tooltip = { fail_text = "ap_recomposer_req_5" tradition_discovery_finish = yes }
	}
	modifier = { modify_species_cost_mult = -0.4 }
	on_enabled = {
		custom_tooltip = "ap_recomposer_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.63 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_recomposer }
		is_gestalt = no
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_recomposer value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_recomposer }
}

ap_megacorp = {
	possible = {
		custom_tooltip = { fail_text = "ap_megacorp_req_1" has_technology = tech_xeno_tourism_agency }
		custom_tooltip = { fail_text = "ap_megacorp_req_2" has_technology = tech_executive_retreat }
		custom_tooltip = {
			fail_text = "ap_megacorp_req_3"
			OR = {
				has_ascension_perk = ap_universal_transactions
				has_civic = civic_criminal_heritage
			}
		}
		host_has_dlc = "Megacorp"
		custom_tooltip = { fail_text = "ap_requires_2_perk" num_ascension_perks > 1 }
	}
	modifier = {
		branch_office_value_mult = 0.4
		# planet_branch_offices_produces_mult = 0.20
		empire_size_branch_office_mult = -0.25
		planet_branch_offices_cost_mult = -0.15
		planet_max_branch_office_buildings_add = 2		# TODO 5 for > 3.4
	}
	on_enabled = {
		custom_tooltip = "ap_megacorp_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.67 }
			# every_playable_country = {
			every_relation = {
				limit = {
					merg_is_default_empire = yes
					NOR = {
						is_same_empire = root
						is_gestalt = yes
						has_modifier = aggressive_marketing_target
						has_ascension_perk = ap_megacorp
						is_at_war_with = root
						is_hostile = root
					}
				}
				add_modifier = { modifier = aggressive_marketing_target }
			}
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_megacorp }
		is_megacorp = yes
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_megacorp value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_megacorp }
}

ap_fallen_disciple = {
	possible = {
		custom_tooltip = { fail_text = "ap_fallen_disciple_req_1" tradition_harmony_finish = yes }
		custom_tooltip = { fail_text = "ap_requires_4_perk" num_ascension_perks > 3 }
	}
	modifier = { }
	on_enabled = {
		custom_tooltip = "ap_fallen_disciple_tooltip_1"
		custom_tooltip = "ap_fallen_disciple_tooltip_2"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.68 }
		}
	}
	potential = {
		NOR = {
			has_ascension_perk = ap_fallen_disciple
			is_homicidal = yes
		}
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_fallen_disciple value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_fallen_disciple }
}

ap_stability_celebration = {
	possible = {
		custom_tooltip = { fail_text = "ap_stability_celebration_req_1" tradition_harmony_finish = yes }
	}
	modifier = {
		planet_stability_add = 5
		# pop_housing_usage_mult = -0.05 # -0.08 removed in v3.4
		pop_amenities_usage_mult = -0.1
		# pop_amenities_usage_no_happiness_mult = -0.10
	}
	on_enabled = {
		custom_tooltip = "ap_stability_celebration_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.80 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_stability_celebration }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_stability_celebration value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_stability_celebration }
}

ap_galaxy_center = {
	possible = {
		# custom_tooltip = { fail_text = "ap_galaxy_center_req_1" has_ascension_perk = ap_arcology_project }
		custom_tooltip = { fail_text = "ap_galaxy_center_req_2" has_technology = tech_zero_point_power }
		custom_tooltip = { fail_text = "ap_galaxy_center_req_3" has_technology = tech_ascension_theory }
		custom_tooltip = { fail_text = "requires_mega_engineering" has_technology = tech_mega_engineering }
		host_has_dlc = "Megacorp"
		host_has_dlc = "Utopia"
		custom_tooltip = {
			fail_text = "ap_galaxy_center_req_7"
			any_owned_planet = {
				gpm_is_planet_class_city = yes # is_possible_galaxy_center
				controller = { is_same_empire = prev.owner }
				num_pops > 20
			}
		}
	}
	modifier = { country_resource_max_add = 40000 }	# 100000
	on_enabled = {
		custom_tooltip = "ap_galaxy_center_tooltip_1"
		custom_tooltip = "ap_galaxy_center_tooltip_2"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.82 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_galaxy_center }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_galaxy_center value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_galaxy_center }
}

ap_advanced_government_1 = {
	possible = {
		# custom_tooltip = { fail_text = "ap_advanced_government_1_req_1" has_ascension_perk = ap_one_vision }
		custom_tooltip = { fail_text = "ap_advanced_government_1_req_2" has_technology = tech_colonial_centralization }
		custom_tooltip = { fail_text = "ap_advanced_government_1_req_3" has_technology = tech_housing_1 }
	}
	modifier = { pop_government_ethic_attraction = 15 pop_ethics_shift_speed_mult = 10 pop_factions_unity_produces_mult = 0.2 }
	on_enabled = {
		custom_tooltip = "ap_advanced_government_1_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.87 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_advanced_government_1 }
		is_gestalt = no
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_advanced_government_1 value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = {
		factor = event_target:global_event_country.ap_advanced_government_1
		modifier = { factor = 2 has_ethic = ethic_authoritarian }
		modifier = { factor = 5 has_ethic = ethic_fanatic_authoritarian }
	}
}

ap_advanced_government_2 = {
	possible = {
		custom_tooltip = {
			fail_text = "ap_advanced_government_2_req_1"
			OR = {
				has_ascension_perk = ap_advanced_government_1
				is_gestalt = yes
			}
		}
		custom_tooltip = { fail_text = "ap_advanced_government_2_req_2" has_technology = tech_galactic_administration }
		custom_tooltip = { fail_text = "ap_advanced_government_2_req_3" has_technology = tech_housing_2 }
		custom_tooltip = { fail_text = "requires_mega_engineering" has_technology = tech_mega_engineering }
		# custom_tooltip = { fail_text = "ap_advanced_government_2_req_4" has_technology = tech_ascension_theory } for stage 4 only
		custom_tooltip = { fail_text = "requires_technology_starbase_4" has_technology = tech_starbase_4 }
	}
	modifier = {
		country_unity_produces_mult = 0.15		# 0.25
	}
	on_enabled = {
		custom_tooltip = "ap_advanced_government_2_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.88 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_advanced_government_2 }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_advanced_government_2 value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_advanced_government_2 }
}

ap_space_merchant = {
	possible = {
		custom_tooltip = { fail_text = "ap_space_merchant_req_1" tradition_prosperity_finish = yes }
		OR = {
			is_gestalt = no
			is_unfriendly = no
		}
	}
	modifier = { country_base_energy_produces_add = 30 } # 40
	on_enabled = {
		custom_tooltip = "ap_space_merchant_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.91 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_space_merchant }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_space_merchant value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = {
		factor = event_target:global_event_country.ap_space_merchant
		modifier = { factor = 0.25 OR = { is_gestalt = yes is_unfriendly = yes } }
	}
}

ap_super_hive_mind = {
	possible = {
		custom_tooltip = { fail_text = "ap_super_hive_mind_req_1" has_technology = tech_colonial_centralization }
		host_has_dlc = "Utopia"
		custom_tooltip = { fail_text = "ap_requires_1_perk" num_ascension_perks > 0 }
	}
	modifier = {
		pop_amenities_usage_mult = -0.15		# -0.25
		planet_crime_mult = -0.15		# -0.3
		planet_pop_assembly_organic_add = 2		# Added v3.3
	}
	on_enabled = {
		custom_tooltip = "ap_super_hive_mind_tooltip_1"
		custom_tooltip = "ap_super_hive_mind_tooltip_2"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.100 }
		}
	}
	potential = {
		is_hive_empire = yes
		NOT = { has_ascension_perk = ap_super_hive_mind }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_super_hive_mind value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_super_hive_mind }
}

ap_mega_hive_mind = {
	possible = {
		custom_tooltip = { fail_text = "ap_mega_hive_mind_req_1" has_ascension_perk = ap_super_hive_mind }
		custom_tooltip = { fail_text = "ap_mega_hive_mind_req_2" has_country_flag = super_hivemind_project }
		custom_tooltip = { fail_text = "ap_mega_hive_mind_req_3" has_technology = tech_ascension_theory }
		host_has_dlc = "Utopia"
		custom_tooltip = { fail_text = "ap_mega_hive_mind_req_5" has_technology = tech_super_hivemind }
	}
	modifier = { }
	on_enabled = {
		custom_tooltip = "ap_mega_hive_mind_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.110 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_mega_hive_mind }
		is_hive_empire = yes
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_mega_hive_mind value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_mega_hive_mind }
}

ap_aggressive_hivemind = {
	possible = {
		custom_tooltip = { fail_text = "ap_aggressive_hivemind_req_1" has_ascension_perk = ap_super_hive_mind }
		custom_tooltip = { fail_text = "ap_aggressive_hivemind_req_2" has_ascension_perk = ap_interstellar_dominion }
		custom_tooltip = { fail_text = "ap_aggressive_hivemind_req_3" has_technology = tech_battleships }
		custom_tooltip = { fail_text = "ap_aggressive_hivemind_req_4" has_technology = tech_starbase_5 }
		host_has_dlc = "Utopia"
	}
	modifier = { country_starbase_influence_cost_mult = -0.1 country_claim_influence_cost_mult = -0.1 country_war_exhaustion_mult = -0.1 }
	on_enabled = {
		custom_tooltip = "ap_aggressive_hivemind_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.120 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_aggressive_hivemind }
		is_hive_empire = yes
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_aggressive_hivemind value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_aggressive_hivemind }
}

ap_connected_hivemind = {
	possible = {
		custom_tooltip = { fail_text = "ap_connected_hivemind_req_1" has_ascension_perk = ap_super_hive_mind }
		host_has_dlc = "Utopia"
	}
	modifier = { planet_jobs_produces_mult = 0.15 }
	on_enabled = {
		custom_tooltip = "ap_connected_hivemind_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.125 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_connected_hivemind }
		is_hive_empire = yes
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_connected_hivemind value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_connected_hivemind }
}

ap_hivemind_reserve = {
	possible = {
		custom_tooltip = { fail_text = "ap_requires_2_perk" num_ascension_perks > 1 }
		years_passed > 14
	}
	modifier = { }
	on_enabled = {
		custom_tooltip = "ap_hivemind_reserve_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.127 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_hivemind_reserve }
		is_hive_empire = yes
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_hivemind_reserve value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_hivemind_reserve }
}

ap_primitives_creation = {
	possible = {
		custom_tooltip = { fail_text = "ap_primitives_creation_req_1" has_technology = tech_society_3 }
		custom_tooltip = { fail_text = "ap_primitives_creation_req_2" has_technology = tech_primitive_initiatives }
	}
	modifier = {
		station_observers_produces_mult = 0.75		# 1.50
		station_observers_unity_produces_add = 10
	}
	on_enabled = {
		custom_tooltip = "ap_primitives_creation_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.140 }
		}
	}
	potential = {
		NOR = {
			has_ascension_perk = ap_primitives_creation
			is_gestalt = yes
			is_unfriendly = yes
		}
		NAND = {
			has_global_flag = life_engineering_installed
			has_life_engineering_installed = yes
		}
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_primitives_creation value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_primitives_creation }
}

ap_powerful_vassals = {
	possible = {
		# custom_tooltip = { fail_text = "ap_powerful_vassals_req_1" OR = { has_ascension_perk = ap_primitives_creation is_gestalt = yes } }
		custom_tooltip = { fail_text = "ap_powerful_vassals_req_2" tradition_domination_finish = yes }
		custom_tooltip = { fail_text = "ap_powerful_vassals_req_3" has_technology = tech_galactic_administration }
		custom_tooltip = { fail_text = "ap_powerful_vassals_req_4" has_technology = tech_vassalisation_initiaves }
		custom_tooltip = { fail_text = "requires_independence" is_subject = no }
		# custom_tooltip = { fail_text = "ap_powerful_vassals_req_6" any_subject = { OR = { is_subject = yes any_agreement = { agreement_preset = preset_protectorate } any_agreement = { agreement_preset = preset_tributary } any_agreement = { agreement_preset = preset_subsidiary } } } }
		custom_tooltip = {
			fail_text = "ap_powerful_vassals_req_7"
			OR = {
				has_valid_civic = civic_fanatic_purifiers
				has_valid_civic = civic_hive_devouring_swarm
				has_valid_civic = civic_inwards_perfection
				has_valid_civic = civic_machine_terminator
				has_ascension_perk = ap_shared_destiny
				is_megacorp = yes
			}
		}
	}
	modifier = { country_subject_acceptance_add = 25 }
	on_enabled = {
		custom_tooltip = "ap_powerful_vassals_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.142 }
		}
	}
	potential = {
		NOR = {
			is_ai = yes
			has_ascension_perk = ap_powerful_vassals
			has_civic = civic_hive_devouring_swarm
		}
	}
	ai_weight = { factor = 0 }	# event_target:global_event_country.ap_powerful_vassals }
}

ap_mechanical_prophet = {
	possible = {
		custom_tooltip = { fail_text = "ap_mechanical_prophet_req_1" has_technology = tech_machine_principle_transfer }
		custom_tooltip = { fail_text = "ap_mechanical_prophet_req_2" has_technology = tech_machine_rebellion }
		custom_tooltip = { fail_text = "ap_requires_2_perk" num_ascension_perks > 1 }
	}
	modifier = { }
	on_enabled = {
		custom_tooltip = "ap_mechanical_prophet_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.200 }
		}
	}
	potential = {
		custom_tooltip = { fail_text = "requires_synthetic_dawn" has_synthethic_dawn = yes }
		NOT = { has_ascension_perk = ap_mechanical_prophet }
		is_synthetic_empire = yes
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_mechanical_prophet value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_mechanical_prophet }
}

ap_machine_core = {
	possible = {
		custom_tooltip = { fail_text = "ap_machine_core_req_1" has_technology = tech_machine_core_schemas }
	}
	modifier = { }
	on_enabled = {
		custom_tooltip = "ap_machine_core_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.210 }
		}
	}
	potential = {
		custom_tooltip = { fail_text = "requires_synthetic_dawn" has_synthethic_dawn = yes }
		NOT = { has_ascension_perk = ap_machine_core }
		is_synthetic_empire = yes
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_machine_core value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_machine_core }
}

ap_defense_sentinels = {
	possible = {
		custom_tooltip = { fail_text = "ap_defense_sentinels_req_1" has_technology = tech_administrative_ai }
		custom_tooltip = {
			fail_text = "ap_defense_sentinels_req_2"
			OR = {
				has_technology = tech_robomodding_m
				has_technology = tech_robomodding
			}
		}
		custom_tooltip = { fail_text = "ap_defense_sentinels_req_3" has_technology = tech_ship_armor_3 }
		custom_tooltip = { fail_text = "ap_defense_sentinels_req_4" has_technology = tech_shields_3 }
		custom_tooltip = { fail_text = "ap_defense_sentinels_req_5" has_technology = tech_plasma_2 }
		custom_tooltip = { fail_text = "ap_defense_sentinels_req_6" has_technology = tech_lasers_2 }
		custom_tooltip = { fail_text = "requires_independence" is_subject = no }
	}
	modifier = { }
	on_enabled = {
		custom_tooltip = "ap_defense_sentinels_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.230 }
		}
	}
	potential = {
		custom_tooltip = { fail_text = "requires_synthetic_dawn" has_synthethic_dawn = yes }
		NOT = { has_ascension_perk = ap_defense_sentinels }
		is_synthetic_empire = yes
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_defense_sentinels value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_defense_sentinels }
}

ap_leadership_transfer = {
	possible = { }
	modifier = { }
	on_enabled = {
		custom_tooltip = "ap_leadership_transfer_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.250 }
		}
	}
	potential = {
		custom_tooltip = { fail_text = "requires_synthetic_dawn" has_synthethic_dawn = yes }
		NOT = { has_ascension_perk = ap_leadership_transfer }
		is_synthetic_empire = yes
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_leadership_transfer value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_leadership_transfer }
}

ap_civilian_activities = {
	possible = {
		custom_tooltip = { fail_text = "requires_independence" is_subject = no }
		custom_tooltip = { fail_text = "ap_civilian_activities_req_1" has_technology = tech_cold_fusion_power }
		custom_tooltip = { fail_text = "ap_civilian_activities_req_2" has_technology = tech_hyper_drive_2 }
	}
	modifier = { }
	on_enabled = {
		custom_tooltip = "ap_civilian_activities_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.260 days = 1 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_civilian_activities }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_civilian_activities value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_civilian_activities }
}

# Pinnacle Society
ap_pyramidal_society = {
	possible = {
		custom_tooltip = { fail_text = "ap_pyramidal_society_req_1" has_technology = tech_pinnacle_company_physics }
		custom_tooltip = { fail_text = "ap_pyramidal_society_req_2" has_technology = tech_pinnacle_company_society }
		custom_tooltip = { fail_text = "ap_pyramidal_society_req_3" has_technology = tech_pinnacle_company_engineering }
	}
	modifier = { planet_max_districts_add = 1 }	# TODO Remove fully?
	on_enabled = {
		custom_tooltip = "ap_pyramidal_society_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.300 }
		}
	}
	potential = {
		NOR = {
			has_ascension_perk = ap_pyramidal_society
			has_country_flag = ap_pyramidal_society
			has_global_flag = ap_pyramidal_society
		}
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_pyramidal_society value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_pyramidal_society }
}

ap_orbital_surgical_strike = {
	possible = {
		custom_tooltip = { fail_text = "ap_orbital_surgical_strike_req_1" has_technology = tech_cruisers }
		custom_tooltip = { fail_text = "ap_orbital_surgical_strike_req_2" tradition_supremacy_finish = yes }
		host_has_dlc = "Apocalypse"
		custom_tooltip = { fail_text = "ap_requires_1_perk" num_ascension_perks > 0 }
	}
	modifier = { ship_orbital_bombardment_mult = 1.5 }
	on_enabled = {
		custom_tooltip = "ap_orbital_surgical_strike_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.310 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_orbital_surgical_strike }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_orbital_surgical_strike value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_orbital_surgical_strike }
}

ap_wheel_fortune = {
	possible = {
		custom_tooltip = { fail_text = "ap_wheel_fortune_req_1" tradition_prosperity_finish = yes }
	}
	modifier = { country_base_treasures_produces_add = 5 }
	on_enabled = {
		custom_tooltip = "ap_wheel_fortune_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.340 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_wheel_fortune }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_wheel_fortune value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_wheel_fortune }
}

ap_underworld = {
	possible = {
		custom_tooltip = { fail_text = "ap_underworld_req_1" has_ascension_perk = ap_wheel_fortune }
		custom_tooltip = { fail_text = "ap_underworld_req_2" has_technology = tech_underworld_smuggler }
		custom_tooltip = {
			fail_text = "ap_underworld_req_3"
			OR = {
				resource_stockpile_compare = { resource = treasures value >= 4000 }
				has_valid_civic = civic_criminal_heritage
			}
		}
	}
	modifier = { }
	on_enabled = {
		custom_tooltip = "ap_underworld_tooltip"
		if = {
			limit = {
				NOT = { has_valid_civic = civic_criminal_heritage }
			}
			add_resource = { treasures = -4000 }
		}
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.370 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_underworld }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_underworld value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_underworld }
}

# v3.3 reduced time
ap_slow_learner = {
	possible = { }
	modifier = { country_base_unity_produces_add = 10 }	# 50 v3.4 (give more later)
	on_enabled = {
		custom_tooltip = "ap_slow_learner_tooltip"
		hidden_effect = {
			if = {
				limit = {
					NOT = {
						has_active_event = { UniqueAscensionPerksEvents.400 UniqueAscensionPerksEvents.401 }
					}
				}
				country_event = { id = UniqueAscensionPerksEvents.400 }
			}
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_slow_learner }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_slow_learner value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_slow_learner }
}

ap_utopian_realisation = {
	possible = {
		custom_tooltip = {
			fail_text = "ap_fallen_disciple_req_1"
			tradition_harmony_finish = yes
		}		# ap_utopian_realisation_req_3
		custom_tooltip = { fail_text = "ap_utopian_realisation_req_1" has_technology = tech_genome_mapping }
		custom_tooltip = { fail_text = "ap_utopian_realisation_req_2" has_technology = tech_epigenetic_triggers }
	}
	modifier = { BIOLOGICAL_species_trait_points_add = 2 }
	on_enabled = {
		custom_tooltip = "ap_utopian_realisation_tooltip"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.410 }
		}
	}
	potential = {
		NOR = {
			has_ascension_perk = ap_utopian_realisation
			has_valid_civic = civic_fanatic_purifiers
		}
		OR = {
			is_gestalt = no
			AND = {
				is_machine_empire = yes
				OR = {
					has_valid_civic = civic_machine_assimilator
					has_valid_civic = civic_machine_servitor
				}
			}
		}
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_utopian_realisation value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_utopian_realisation }
}

ap_antimatter = {
	possible = {
		custom_tooltip = { fail_text = "ap_requires_3_perk" num_ascension_perks > 2 }
	}
	# v3.4 reduced from 0.25
	modifier = { ship_speed_mult = 0.15 }
	on_enabled = {
		custom_tooltip = "ap_antimatter_tooltip"
		# custom_tooltip = "describe_edict_anti_matter_menu"
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.430 }
		}
	}
	potential = {
		NOT = { has_ascension_perk = ap_antimatter }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_antimatter value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_antimatter }
}

ap_deep_scanner = {
	possible = {
		custom_tooltip = { fail_text = "ap_deep_scanner_req_1" has_technology = tech_physics_2 }
		custom_tooltip = { fail_text = "ap_deep_scanner_req_2" has_technology = tech_automated_exploration }
		custom_tooltip = { fail_text = "ap_deep_scanner_req_3" has_technology = tech_sensors_2 }
		custom_tooltip = { fail_text = "ap_deep_scanner_req_4" has_technology = tech_combat_computers_1 }
	}
	modifier = {
		# v3.3 halved values
		# ship_anomaly_generation_chance_mult = 0.50 replaced with policy
		country_physics_tech_research_speed = 0.05 # 0.2 replaced with computing v.3.8
		category_computing_research_speed_mult = 0.15
	}
	on_enabled = {
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.440 }
		}
		custom_tooltip = "ap_deep_scanner_tooltip"
	}
	potential = {
		NOR = {
			has_ascension_perk = ap_deep_scanner
			has_civic = civic_exploration # Compat. E&CC
		}
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_deep_scanner value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_deep_scanner }
}

ap_artifact_hunter = {
	possible = {
		custom_tooltip = { fail_text = "ap_artifact_hunter_req_1" has_ascension_perk = ap_deep_scanner }
		custom_tooltip = { fail_text = "ap_artifact_hunter_req_2" has_technology = tech_physics_3 }
		custom_tooltip = { fail_text = "ap_artifact_hunter_req_3" has_technology = tech_sensors_3 }
		custom_tooltip = { fail_text = "ap_artifact_hunter_req_4" has_technology = tech_combat_computers_2 }
		has_ancrel = yes
	}
	modifier = {
		# v3.3 halved values
		ship_archaeological_site_excavation_speed_mult = 0.5
		category_archaeostudies_research_speed_mult = 0.15 # v.3.8
		ship_archaeological_site_clues_add = 1
	}
	on_enabled = {
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.450 }
		}
		custom_tooltip = "ap_artifact_hunter_tooltip"
	}
	potential = {
		NOT = { has_ascension_perk = ap_artifact_hunter }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_artifact_hunter value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_artifact_hunter }
}

ap_self_aware_colony = {
	possible = {
		custom_tooltip = { fail_text = "ap_self_aware_colony_req_1" tradition_expansion_finish = yes }
		custom_tooltip = { fail_text = "ap_self_aware_colony_req_2" has_technology = tech_housing_2 }
		custom_tooltip = { fail_text = "ap_self_aware_colony_req_3" has_technology = tech_power_hub_2 }
		custom_tooltip = { fail_text = "ap_self_aware_colony_req_4" has_technology = tech_food_processing_2 }
		custom_tooltip = { fail_text = "ap_self_aware_colony_req_5" has_technology = tech_mineral_purification_2 }
	}
	modifier = {
		country_base_minerals_produces_add = 30 # 40
		country_resource_max_minerals_add = 20000
	}
	on_enabled = {
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.460 }
		}
		custom_tooltip = "ap_self_aware_colony_tooltip"
	}
	potential = {
		NOT = {
			has_ascension_perk = ap_self_aware_colony
			# has_global_flag = ap_self_aware_colony
		}
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_self_aware_colony value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_self_aware_colony }
}

ap_flourishing_technocracy = {
	possible = {
		custom_tooltip = { fail_text = "ap_flourishing_technocracy_req_1" OR = { tradition_discovery_finish = yes has_civic = civic_technocracy } }
		custom_tooltip = { fail_text = "ap_flourishing_technocracy_req_2" OR = { has_technology = tech_basic_science_lab_3 has_civic = civic_technocracy } }
		custom_tooltip = { fail_text = "ap_flourishing_technocracy_req_3" OR = { has_technology = tech_physics_3 has_civic = civic_technocracy } }
		custom_tooltip = { fail_text = "ap_flourishing_technocracy_req_4" OR = { has_technology = tech_society_3 has_civic = civic_technocracy } }
		custom_tooltip = { fail_text = "ap_flourishing_technocracy_req_5" OR = { has_technology = tech_engineering_3 has_civic = civic_technocracy } }
	}
	modifier = {
		country_physics_research_produces_mult = 0.05
		country_society_research_produces_mult = 0.05
		country_engineering_research_produces_mult = 0.05
		# planets_physics_research_produces_add = 1 # planet_researchers_physics_research_produces_add = 1
		# planets_society_research_produces_add = 1 # planet_researchers_society_research_produces_add = 1
		# planets_engineering_research_produces_add = 1 # planet_researchers_engineering_research_produces_add = 1
		planet_farmers_society_research_produces_add = 0.1
		planet_miners_engineering_research_produces_add = 0.1
		planet_technician_physics_research_produces_add = 0.1
		planet_metallurgists_engineering_research_produces_add = 0.25
		planet_artisans_engineering_research_produces_add = 0.25
		# planet_culture_workers_society_research_produces_add = 1
		# planet_entertainers_physics_research_produces_add = 1
		planet_priests_society_research_produces_add = 1
		# planet_managers_society_research_produces_add = 1
		# planet_doctors_society_research_produces_add = 1
		# planet_refiners_engineering_research_produces_add = 1
		# planet_chemists_physics_research_produces_add = 1
		# planet_translucers_physics_research_produces_add = 1
		# planet_pop_assemblers_engineering_research_produces_add = 2
		planet_enforcers_society_research_produces_add = 0.5
		planet_soldiers_society_research_produces_add = 0.25
		# planet_pops_unemployed_physics_research_produces_add = 1
		# planet_pops_unemployed_society_research_produces_add = 1
		# planet_pops_unemployed_engineering_research_produces_add = 1
		station_researchers_produces_mult = 0.5
	}
	on_enabled = {
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.470 }
		}
		custom_tooltip = "ap_flourishing_technocracy_tooltip"
	}
	potential = {
		NOT = { has_ascension_perk = ap_flourishing_technocracy }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_flourishing_technocracy value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = {
		factor = event_target:global_event_country.ap_flourishing_technocracy
		modifier = { factor = 2 has_ethic = ethic_materialist }
		modifier = { factor = 5 has_ethic = ethic_fanatic_materialist }
	}
}

ap_legendary_forge = {
	possible = {
		custom_tooltip = { fail_text = "ap_legendary_forge_req_1" has_technology = tech_alloys_2 }
		custom_tooltip = { fail_text = "ap_legendary_forge_req_2" has_technology = tech_mine_living_metal }
		custom_tooltip = { fail_text = "ap_legendary_forge_req_3" has_technology = tech_volcano }
	}
	modifier = { planet_metallurgists_alloys_produces_add = 1 country_base_sr_living_metal_produces_add = 2 }
	on_enabled = {
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.480 }
		}
		custom_tooltip = "ap_legendary_forge_tooltip"
	}
	potential = {
		NOT = { has_ascension_perk = ap_legendary_forge }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_legendary_forge value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_legendary_forge }
}

ap_library_wisedom = {
	possible = {
		custom_tooltip = { fail_text = "ap_library_wisedom_req_1" tradition_harmony_finish = yes }
		custom_tooltip = { fail_text = "ap_library_wisedom_req_2" has_technology = tech_adaptive_bureaucracy }
		custom_tooltip = { fail_text = "ap_library_wisedom_req_3" has_technology = tech_interstellar_fleet_traditions }
		custom_tooltip = { fail_text = "ap_library_wisedom_req_4" has_technology = tech_society_2 }
	}
	modifier = { country_base_unity_produces_add = 50 }	# 100 < v3.4
	on_enabled = {
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.490 }
		}
		custom_tooltip = "ap_library_wisedom_tooltip"
	}
	potential = {
		NOT = { has_ascension_perk = ap_library_wisedom }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_library_wisedom value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_library_wisedom }
}

ap_expansionist_development = {
	possible = {
		custom_tooltip = { fail_text = "ap_expansionist_development_req_1" tradition_expansion_finish = yes }
		# custom_tooltip = { fail_text = "ap_expansionist_development_req_2" has_technology = tech_automated_exploration }
	}
	modifier = {
		country_starbase_influence_cost_mult = -0.1		# -0.15
		# country_admin_cap_add = 100 		# Removed 3.3
		# empire_size_penalty_mult = -0.25 	# Removed 3.3
		# Added 3.3
		empire_size_systems_mult = -0.1		# -0.15
		empire_size_colonies_mult = -0.1		# -0.15
		empire_size_pops_mult = -0.1		# -0.15
	}
	on_enabled = {
		hidden_effect = {
			country_event = { id = UniqueAscensionPerksEvents.530 }
		}
		custom_tooltip = "ap_expansionist_development_tooltip"
	}
	potential = {
		NOT = { has_ascension_perk = ap_expansionist_development }
		OR = {
			is_ai = no
			event_target:global_event_country = {
				check_variable = { which = ap_expansionist_development value > 0 }
			}
		}		# because ai_weight doesn't work
	}
	ai_weight = { factor = event_target:global_event_country.ap_expansionist_development }
}

# ap_dark_galaxy_web = {
#	possible = {
#		custom_tooltip = { fail_text = "ap_dark_galaxy_web_req_1" has_technology = tech_administrative_ai }
#		custom_tooltip = { fail_text = "ap_dark_galaxy_web_req_1" has_technology = tech_sensors_2 }
#		custom_tooltip = { fail_text = "ap_dark_galaxy_web_req_1" has_technology = tech_power_plant_2 }
#		custom_tooltip = { fail_text = "ap_dark_galaxy_web_req_1" has_technology = tech_ground_defense_planning }
#	}
#	modifier = { }
#	on_enabled = {
#		hidden_effect = { country_event = { id = UniqueAscensionPerksEvents.540 } }
#		custom_tooltip = "ap_dark_galaxy_web_tooltip"
#	}
#	potential = { NOT = { has_ascension_perk = ap_dark_galaxy_web } }
#	ai_weight = { factor = 0 }
#}
